<%= render :partial => "/shared/web/common/loggedin_header", locals: {user: user} %>
<div class="container" style="padding-bottom: 80px">
  <div class="row">
    <div class="col-xs-12">
      <div class="text-center">
        <img src="https://d36lai1ppm9dxu.cloudfront.net/assets/logo/logo-with-tagline-mobile.png" width="211"/>
      </div>
      <%=
          unless is_update
            render partial: '/shared/web/common/steps',
                   locals: {
                           classes: {
                                   step_2: 'active',
                                   step_3: 'incomplete',
                                   connector_2: 'incomplete'
                           }
                   }
          end
      %>

      <div class="simple-token-form">
        <form class="simpletoken-form" action="/api/user/kyc-submit" method="POST" id="kycForm">
          <div class="col-xs-12 col-sm-12 col-md-8 col-md-offset-2">
            <% if is_update %>
                <h1 class="text-center form-header" style="margin-bottom: 30px">Re-submit your personal information to continue. <br/>Your previous details have been deleted.</h1>
            <% else %>
                <h1 class="text-center form-header" style="margin-bottom: 30px">Register by submitting the details below</h1>
            <% end %>

            <div class="row">
              <div class="col-xs-12 col-sm-6">
                <div class="form-group">
                  <label for="first_name">First name</label>
                  <input type="text" title="First name" class="form-control" name="first_name" value="" tabindex="1" autofocus="" autocomplete="off" required/>
                  <div class="error" data-for="first_name"></div>
                </div>
              </div>
              <div class="col-xs-12 col-sm-6">
                <div class="form-group">
                  <label for="last_name">Last name</label>
                  <input type="text" title="Last name" class="form-control" name="last_name" value="" tabindex="2" autocomplete="off" required/>
                  <div class="error" data-for="last_name"></div>
                </div>
              </div>
            </div>

            <div class="row">
              <div class="col-xs-12 col-sm-6">
                <div class="form-group">
                  <label for="birthdate">Date of Birth</label>
                  <input type="text" title="Birth date" class="form-control" name="birthdate" placeholder="dd/mm/yyyy" pattern="(0[1-9]|1[0-9]|2[0-9]|3[01])[- /.](0[1-9]|1[012])[- /.][0-9]{4}" tabindex="3" autocomplete="off" required/>
                  <div class="error" data-for="birthdate"></div>
                </div>
              </div>
            </div>

            <div class="row">
              <div class="col-xs-12 col-sm-6">
                <div class="form-group">
                  <label for="street_address">Street address</label>
                  <input type="text" title="Street address" class="form-control" name="street_address" value="" tabindex="5" autocomplete="off" required/>
                  <div class="error" data-for="street_address"></div>
                </div>
              </div>
              <div class="col-xs-12 col-sm-6">
                <div class="form-group">
                  <label for="">City</label>
                  <input type="text" title="City" class="form-control" name="city" value="" tabindex="6" autocomplete="off" required/>
                  <div class="error" data-for="city"></div>
                </div>
              </div>
            </div>

            <div class="row">
              <div class="col-xs-12 col-sm-6">
                <div class="form-group">
                  <label for="state">State / region</label>
                  <input type="text" title="State / region" class="form-control" name="state" value="" tabindex="7" autocomplete="off" required/>
                  <div class="error" data-for="state"></div>
                </div>
              </div>
              <div class="col-xs-12 col-sm-6">
                <div class="form-group st-selectpicker">
                  <label for="country">Country</label>
                  <select class="form-control selectpicker" name="country" tabindex="8" required>
                    <% GlobalConstant::CountryNationality.countries.each do |country_name|  %>
                        <option value="<%= country_name %>" <%= @ip_to_cynopsis_country.to_s.upcase == country_name ? 'selected' : '' %>><%= country_name.titleize %></option>
                    <% end %>
                  </select>
                  <div class="error" data-for="country"></div>
                </div>
              </div>
            </div>

            <div class="row">
              <div class="col-xs-12 col-sm-6">
                <div class="form-group">
                  <label for="postal_code">Zip / postal code</label>
                  <input type="text" title="Zip / postal code" class="form-control" name="postal_code" value="" tabindex="9" autocomplete="off" required/>
                  <div class="error" data-for="postal_code"></div>
                </div>
              </div>
            </div>

            <div class="row">
              <div class="col-xs-12 col-sm-6">
                <div class="form-group">
                  <label for="ethereum_address">Ethereum address</label>
                  <input type="text" title="Ethereum address" class="form-control" name="ethereum_address" pattern="(0x|0X)?[0-9a-fA-F]{40}" value="" tabindex="10" autocomplete="off" required/>
                  <div class="error" data-for="ethereum_address"></div>
                </div>
              </div>
              <div class="col-xs-12 col-sm-6">
                <div class="form-instructions">
                  You will be able to participate in this Token Sale <br/>only by using this specific address. Learn
                  more <br/>in the <a href="https://docs.google.com/document/d/1WVPQyUZgul81MoF2DkmsAeA6vPpKJ8vtjS53GWeSov4/edit" title="Registration Guide" target="_blank">Registration Guide</a>
                </div>
              </div>
            </div>

            <div class="row">
              <div class="col-xs-12 col-sm-6">
                <div class="form-group">
                  <label for="estimated_participation_amount">Estimated participation amount ($)</label>
                  <input type="number" min="1" lang="en-150" title="Estimated amount ($)" class="form-control" name="estimated_participation_amount" value="" tabindex="11" autocomplete="off" required/>
                  <div class="error" data-for="estimated_participation_amount"></div>
                </div>
              </div>
              <div class="col-xs-12 col-sm-6">
                <div class="form-instructions">
                  Estimated amount in USD that you would like to <br/>participate with.<br/>
                </div>
              </div>
            </div>


            <div class="row">
              <div class="col-xs-12 col-sm-6">

                <div class="form-group">
                  <label for="passport_number">Passport number</label>
                  <input type="text" title="Passport number" class="form-control" name="passport_number" value="" tabindex="12" autocomplete="off" required/>
                  <div class="error" data-for="passport_number"></div>
                </div>

                <div class="form-group st-selectpicker">
                  <label for="nationality">Nationality</label>
                  <select class="form-control selectpicker" name="nationality" tabindex="13" required>
                    <% GlobalConstant::CountryNationality.nationalities.each do |nationality_name| %>
                        <option value="<%= nationality_name %>"><%= nationality_name.titleize %></option>
                    <% end %>
                  </select>
                  <div class="error" data-for="nationality"></div>
                </div>

              </div>
            </div>

            <div class="row">
              <div class="col-xs-12 col-sm-12">

                <div class="form-group">
                  <label for="passport_file_path">passport photo page image <span class="badge">i</span></label>
                  <div class="file-name"></div>
                  <div>
                    <label class="upload-file btn-common btn-grey upload-image-btn">
                      <input type="file" title="Passport scan" name="passport_file_path" class="upload btn btn-orange" accept="image/*,application/pdf" data-min-bytes="204800" data-max-bytes="15728640" tabindex="14" required/>
                      <span>choose file</span>
                    </label>
                    <span class="form-instructions thumbnail-upload-instructions">Please upload a high quality <br/>scan or picture of your passport photo page.<br/>(Min 200kb, JPG/PNG/PDF only)</span>

                  </div>
                  <div class="error" data-for="passport_file_path"></div>
                </div>
              </div>
            </div>

            <div class="row">
              <div class="col-xs-12 col-sm-12">
                <div class="form-group">
                  <label for="selfie_file_path">Upload a selfie with your passport <span class="badge">i</span></label>
                  <div class="file-name"></div>
                  <div>
                    <label class="upload-file btn-common btn-grey upload-image-btn">
                      <input type="file" title="Selfie with your passport" name="selfie_file_path" class="upload btn btn-orange" accept="image/*,application/pdf" data-min-bytes="204800" data-max-bytes="15728640" tabindex="15" required>
                      <span>choose file</span>
                    </label>
                    <span class="form-instructions thumbnail-upload-instructions">Please upload a high quality <br/>picture of you holding your passport <br/>photo page next to your face. <br/>(Min 200kb, JPG/PNG/PDF only)</span>
                  </div>
                  <div class="error" data-for="selfie_file_path"></div>
                </div>
              </div>
            </div>

            <div class="row residence-proof" style="display:none">
              <div class="col-xs-12 col-sm-12">
                <div class="form-group">
                  <label for="residence_proof_file_path">Proof of Residence</label>
                  <div class="file-name"></div>
                  <div>
                    <label class="upload-file btn-common btn-grey upload-image-btn">
                      <input type="file" title="Residence proof" name="residence_proof_file_path" class="upload btn btn-orange" accept="image/*,application/pdf" data-min-bytes="204800" data-max-bytes="15728640" tabindex="16" required/>
                      <span>choose file</span>
                    </label>
                    <span class="form-instructions thumbnail-upload-instructions">Please upload a high quality <br/>scan of your proof of residence.<br/> (Min 200kb, JPG/PNG/PDF only)</span>
                  </div>
                  <div class="error" data-for="residence_proof_file_path"></div>
                </div>
              </div>
            </div>

            <div class="row">
              <div class="col-xs-12 col-sm-6">
                <div class="g-recaptcha" data-sitekey="<%= GlobalConstant::Base.recaptcha['site_key'] %>" tabindex="17"></div>
                <div class="error" data-for="recaptcha"></div>
              </div>
            </div>

            <div class="error" data-for="general_error"></div>

            <div class="row">
              <div class="col-xs-12 col-sm-12">
                <div class="form-group">
                  <div>
                    <button id="kycSubmit" class="btn-common btn-gold upload-image-btn" title="submit" type="submit" tabindex="17" style="margin-top: 20px">Submit</button>
                    <% if is_update %>
                    <a href="/dashboard" class="btn-common btn-grey upload-image-btn" title="back" tabindex="18" style="margin-right: 20px;margin-top: 20px">Back</a>
                    <% end %>
                  </div>
                </div>
              </div>
            </div>

          </div>
          <%= hidden_field_tag :authenticity_token, form_authenticity_token -%>
        </form>
        <div id="fileupload"></div>
        <input type="hidden" id="refresh-indicator" value="no">
      </div>
    </div>
  </div>
</div>

<% content_for :end_js do %>
    <script src='https://www.google.com/recaptcha/api.js'></script>
    <script>
        $(document).ready(function () {
            simpletoken.home.kyc.init({is_update: <%= is_update %>});
        });
    </script>
<% end %>

<%= render :partial => "/shared/web/modals/verify_modal" %>

<script type="custom" id="selfie-popover">
  <div style="">
      <div class="row">
        <div class="col-xs-5">
          <img src="https://d36lai1ppm9dxu.cloudfront.net/assets/image/kyc-passport-selfie-right-image@2x-v2.png" style="max-width:100%" />
        </div>
        <div class="col-xs-7">
          <p style="font-size:10px; color:#9aaaaa">Please hold the passport photo page in your hand next to your face. Both your face and the passport must be clearly visible and any text, numbers or photos on the passport must be readable and not be covered by your fingers.</p>
        </div>
      </div>
      <div class="row">
        <div class="col-xs-12">
          <img src="https://d36lai1ppm9dxu.cloudfront.net/assets/image/kyc-passport-selfie-wrong-image@2x-v2.png" style="max-width:100%" />
        </div>
      </div>
  </div>
</script>

<script type="custom" id="passport-popover">
  <div style="">
      <div class="row">
        <div class="col-xs-5">
          <img src="https://d36lai1ppm9dxu.cloudfront.net/assets/image/kyc-passport-right-image@2x.png" style="max-width:100%" />
        </div>
        <div class="col-xs-7">
          <p style="font-size:10px; color:#9aaaaa">Please upload a scan or picture of your passport photo page so that the entire page is visible, the image is not blurry and the camera flash is not affecting the readability. All text, numbers and photos on the passport must be readable.</p>
        </div>
      </div>
      <div class="row">
        <div class="col-xs-12">
          <img src="https://d36lai1ppm9dxu.cloudfront.net/assets/image/kyc-passport-wrong-image@2x.png" style="max-width:100%" />
        </div>
      </div>
  </div>
</script>